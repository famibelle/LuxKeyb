name: ğŸ·ï¸ Create Tag v2.5.0

on:
  workflow_dispatch:
    inputs:
      create_tag:
        description: "Create v2.5.0 tag and trigger release"
        required: true
        default: true
        type: boolean

jobs:
  create-tag-v2-5-0:
    name: ğŸ·ï¸ Create v2.5.0 Tag
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
    - name: ğŸ“¥ Checkout Repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
        
    - name: ğŸ” Verify Version in build.gradle
      working-directory: android_keyboard
      run: |
        VERSION_FROM_GRADLE=$(grep "versionName" app/build.gradle | sed 's/.*"\(.*\)".*/\1/')
        echo "Version in build.gradle: $VERSION_FROM_GRADLE"
        if [[ "$VERSION_FROM_GRADLE" != "2.5.0" ]]; then
          echo "âŒ Version mismatch! Expected 2.5.0, got $VERSION_FROM_GRADLE"
          echo "Please update versionName in app/build.gradle to '2.5.0'"
          exit 1
        fi
        echo "âœ… Version check passed: $VERSION_FROM_GRADLE"
        
    - name: ğŸ·ï¸ Create and Push Tag v2.5.0
      run: |
        # Configuration Git
        git config user.name "GitHub Actions"
        git config user.email "actions@github.com"
        
        # VÃ©rifier si le tag existe dÃ©jÃ 
        if git rev-parse "v2.5.0" >/dev/null 2>&1; then
          echo "âš ï¸ Tag v2.5.0 already exists"
          echo "Deleting existing tag..."
          git tag -d v2.5.0
          git push origin :refs/tags/v2.5.0 || true
        fi
        
        # CrÃ©er le nouveau tag
        echo "ğŸ·ï¸ Creating tag v2.5.0..."
        git tag -a v2.5.0 -m "ğŸ‡¬ğŸ‡µ KlaviÃ© KreyÃ²l Karukera v2.5.0 â€¢ Potomitanâ„¢

        Nouvelle version stable du clavier crÃ©ole guadeloupÃ©en !
        
        ğŸ¯ NouveautÃ©s v2.5.0:
        - ğŸ”§ AmÃ©lioration majeure du systÃ¨me Shift
        - ğŸ› Correction barre espace 
        - ğŸ“Š Logs de dÃ©bogage Ã©tendus
        - ğŸ”„ Optimisation mode clavier
        - ğŸ¨ StabilitÃ© interface
        
        âœ¨ FonctionnalitÃ©s:
        - ğŸŒˆ Design moderne caribÃ©en
        - ğŸ“ Suggestions intelligentes (5910 mots crÃ©oles)
        - ğŸ”¤ Accents crÃ©oles natifs (Ã , Ã¨, Ã², etc.)
        - ğŸ“š Sources littÃ©raires intÃ©grÃ©es
        - ğŸ¯ Optimisation Samsung
        
        AlÃ© douvan Ã©pi klaviÃ© kreyÃ²l-la ! âŒ¨ï¸âœ¨"
        
        # Pousser le tag
        echo "ğŸ“¤ Pushing tag to GitHub..."
        git push origin v2.5.0
        
        echo "âœ… Tag v2.5.0 created and pushed successfully!"
        echo "ğŸš€ This will trigger the release workflow automatically."
        
    - name: ğŸ‰ Success Message
      run: |
        echo "ğŸ‰ Tag v2.5.0 created successfully!"
        echo ""
        echo "ğŸ“‹ Next steps:"
        echo "1. âœ… Tag v2.5.0 has been pushed to GitHub"
        echo "2. ğŸš€ Release workflow will start automatically"
        echo "3. ğŸ“± APKs will be built and attached to the release"
        echo "4. ğŸ”— Release will be available at: https://github.com/${{ github.repository }}/releases/tag/v2.5.0"
        echo ""
        echo "â±ï¸ Expected completion time: ~5-10 minutes"